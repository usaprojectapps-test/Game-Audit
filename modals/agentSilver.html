<div class="module-container">

  <div class="module-wrapper">

    <!-- ============================
         LEFT SIDE (65%)
    ============================= -->
    <div class="module-left">

      <!-- FILTER ROW -->
      <div class="filters-row">

        <!-- Date -->
        <input id="as_filter_date" type="date">

        <!-- Location Filter -->
        <select id="as_filter_location"></select>

        <!-- User Filter -->
        <select id="as_filter_user"></select>

      </div>

      <!-- DAILY SUMMARY -->
      <div class="summary-row" id="as_summary_row">
        <div>Total Slips: <span id="as_sum_slips">0</span></div>
        <div>Total Amount: <span id="as_sum_amount">0.00</span></div>
        <div>Total Bonus: <span id="as_sum_bonus">0.00</span></div>
        <div>Grand Total: <span id="as_sum_grand">0.00</span></div>
      </div>

      <!-- TABLE -->
      <div class="table-wrapper full-width">
        <table>
          <thead>
            <tr>
              <th>Slip ID</th>
              <th>Date</th>
              <th>Agent</th>
              <th>Machine</th>
              <th>Amount</th>
            </tr>
          </thead>
          <tbody id="as_table_body"></tbody>
        </table>
      </div>

    </div>

    <!-- ============================
         RIGHT SIDE (35%)
    ============================= -->
    <div class="module-right">

      <div class="card-header">Create Slip</div>

      <!-- SLIP TYPE BUTTON TOGGLE -->
      <div class="form-group form-span-2">
        <label>Slip Type</label>

        <div class="as-slip-type-buttons">
          <button id="asBtnRegular" class="as-slip-btn active">Regular</button>
          <button id="asBtnBonus" class="as-slip-btn">Bonus</button>
        </div>
      </div>

      <div class="form-grid">

        <!-- Date -->
        <div class="form-group">
          <label>Date & Time</label>
          <input id="asDateTime" type="datetime-local">
        </div>

        <!-- Agent Name -->
        <div class="form-group">
          <label>Agent Name</label>
          <input id="asAgentName" type="text" disabled>
        </div>

        <!-- Machine No (Regular Only) -->
        <div class="form-group form-span-2" id="rowMachineNo">
          <label>Machine No</label>
          <div class="qr-input-group">
            <input id="asMachineNo" type="text">
            <button id="asScanBtn">Scan</button>
          </div>
        </div>

        <!-- Amount (Regular Only) -->
        <div class="form-group form-span-2" id="rowAmount">
          <label>Amount ($)</label>
          <input id="asAmount" type="number" value="0.00" disabled>
        </div>

        <!-- Bonus Type (Bonus Only) -->
        <div class="form-group form-span-2" id="rowBonusType" style="display:none;">
          <label>Bonus Type</label>
          <select id="asBonusType">
            <option value="">Select Bonus</option>
            <option value="Raffle">Raffle</option>
            <option value="Birthday Gift">Birthday Gift</option>
            <option value="Festival Bonus">Festival Bonus</option>
            <option value="Promo Bonus">Promo Bonus</option>
          </select>
        </div>

        <!-- Bonus Amount (Bonus Only) -->
        <div class="form-group form-span-2" id="rowBonusAmount" style="display:none;">
          <label>Bonus Amount ($)</label>
          <input id="asBonusAmount" type="number" value="0.00">
        </div>

      </div>

      <!-- ACTIONS -->
      <div class="form-actions">
        <button id="asSaveBtn" class="btn btn-primary">Save & Print</button>
      </div>

      <!-- QR PREVIEW -->
      <div class="qr-preview-column">
        <div class="qr-preview-box">
          <canvas id="asQrCanvas" width="128" height="128"></canvas>
        </div>
        <div id="asQrText" style="font-size:12px; color:#ccc; text-align:center;">
          QR will appear after saving
        </div>
      </div>

    </div>

  </div>

</div>

<!-- ============================
     PRINT MODAL (BOTTOM OF PAGE)
============================= -->
<div id="asPrintOverlay" style="
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.5);
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 9999;
">
  <div id="asPrintModal" style="
    background: #fff;
    padding: 15px;
    border-radius: 8px;
    width: 320px;
    box-shadow: 0 0 10px rgba(0,0,0,0.3);
  ">
    <div class="slip-container" style="width:300px;border:1px solid #333;padding:15px;border-radius:8px;font-family:Arial,sans-serif;">
      <div style="text-align:center;font-weight:bold;margin-bottom:10px;">Agent Silver Slip</div>

      <div style="display:flex;justify-content:space-between;margin:4px 0;">
        <span>Slip ID:</span> <span id="asModalSlipId"></span>
      </div>
      <div style="display:flex;justify-content:space-between;margin:4px 0;">
        <span>Date/Time:</span> <span id="asModalSlipDateTime"></span>
      </div>
      <div style="display:flex;justify-content:space-between;margin:4px 0;">
        <span>Agent:</span> <span id="asModalSlipAgent"></span>
      </div>

      <div id="asModalRowMachine" style="display:flex;justify-content:space-between;margin:4px 0;">
        <span>Machine:</span> <span id="asModalSlipMachine"></span>
      </div>
      <div id="asModalRowAmount" style="display:flex;justify-content:space-between;margin:4px 0;">
        <span>Amount:</span> <span id="asModalSlipAmount"></span>
      </div>

      <div id="asModalRowBonusType" style="display:none;justify-content:space-between;margin:4px 0;">
        <span>Bonus Type:</span> <span id="asModalSlipBonusType"></span>
      </div>
      <div id="asModalRowBonusAmount" style="display:none;justify-content:space-between;margin:4px 0;">
        <span>Bonus Amount:</span> <span id="asModalSlipBonusAmount"></span>
      </div>

      <div style="text-align:center;margin-top:15px;">
        <canvas id="asModalQrCanvas" width="128" height="128"></canvas>
        <div style="font-size:12px;color:#666;">Scan to confirm payment</div>
      </div>

      <div style="text-align:center;font-size:12px;margin-top:10px;border-top:1px dashed #999;padding-top:5px;">
        Game Audit System
      </div>

      <div style="margin-top:10px;display:flex;justify-content:space-between;">
        <button id="asModalPrintBtn">Print</button>
        <button id="asModalCloseBtn">Close</button>
      </div>
    </div>
  </div>
</div>

<!-- PRINT CSS -->
<style>
  @media print {
    body * {
      visibility: hidden !important;
    }
    #asPrintOverlay, #asPrintOverlay * {
      visibility: visible !important;
    }
    #asPrintOverlay {
      position: fixed;
      inset: 0;
    }
  }

  .as-slip-type-buttons {
    display: flex;
    gap: 10px;
  }

  .as-slip-btn {
    flex: 1;
    padding: 10px;
    border-radius: 6px;
    border: 1px solid #444;
    background: #222;
    color: #fff;
    font-size: 14px;
    cursor: pointer;
    transition: 0.2s;
  }

  .as-slip-btn.active {
    background: #007bff;
    border-color: #007bff;
  }
</style>

<!-- QRious -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/qrious/4.0.2/qrious.min.js"></script>

<!-- Agent Silver JS -->
<script type="module" src="/js_new/agentSilver.js"></script>
