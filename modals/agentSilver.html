<div class="module-container">

  <div class="module-wrapper">

    <!-- ============================
         LEFT SIDE (65%)
    ============================= -->
    <div class="module-left">

      <!-- FILTER ROW -->
      <div class="filters-row">

        <!-- Date -->
        <div class="as-filter-row">
          <label for="as_filter_date">Date</label>
          <input type="date" id="as_filter_date" class="as-filter-input" />
        </div>


        <!-- Location Filter -->
        <select id="as_filter_location"></select>

        <!-- User Filter -->
        <select id="as_filter_user"></select>

      </div>

      <!-- DAILY SUMMARY -->
      <div class="as-summary-row">
        <div class="as-summary-item">Slips: <span id="as_sum_slips">0</span></div>
        <div class="as-summary-item">Amount: <span id="as_sum_amount">0.00</span></div>
        <div class="as-summary-item">Bonus: <span id="as_sum_bonus">0.00</span></div>
        <div class="as-summary-item">Grand: <span id="as_sum_grand">0.00</span></div>
      </div>


      <!-- TABLE -->
      <div class="table-wrapper full-width">
        <table>
          <thead>
            <tr>
              <th>Slip ID</th>
              <th>Date</th>
              <th>Agent</th>
              <th>Machine</th>
              <th>Amount</th>
            </tr>
          </thead>
          <tbody id="as_table_body"></tbody>
        </table>
      </div>

    </div>

<!-- ============================
         RIGHT SIDE (35%)
============================= -->
<div class="module-right">

  <!-- HEADER + AGENT INLINE -->
  <div class="card-header" 
       style="display:flex; justify-content:space-between; align-items:center;">
    <div>Create Slip</div>
    <input type="text" id="asAgentName" disabled style="max-width:160px;" />
  </div>

  <div class="form-grid">

    <!-- SLIP TYPE TOGGLE -->
    <div class="form-span-2">
      <label>Slip Type</label>
      <div class="as-slip-type-buttons">
        <button id="asBtnRegular" class="as-slip-btn active">Regular</button>
        <button id="asBtnBonus" class="as-slip-btn">Bonus</button>
      </div>
    </div>

    <!-- ROW 1: DATE -->
    <div class="form-group" style="grid-column:1;">
      <label>Date & Time</label>
      <input type="datetime-local" id="asDateTime" />
    </div>

    <!-- EMPTY RIGHT CELL (keeps grid aligned) -->
    <div class="form-group"></div>

    <!-- ROW 2: MACHINE NO (REGULAR) -->
    <div class="form-group" id="rowMachineNo" style="grid-column:1;">
      <label>Machine No</label>
      <div class="qr-input-group">
        <input type="text" id="asMachineNo" />
        <button id="asScanBtn">Scan</button>
      </div>
    </div>

    <!-- ROW 2: BONUS TYPE (BONUS MODE) -->
    <div class="form-group" id="rowBonusType" style="grid-column:1; display:none;">
      <label>Bonus Type</label>
      <select id="asBonusType">
        <option value="">Select Bonus</option>
      </select>
    </div>

    <!-- QR PREVIEW (RIGHT SIDE) -->
    <div class="form-group" style="grid-column:2; grid-row:2 / span 3;">
      <label>Slip QR</label>
      <div class="qr-preview-box">
        <canvas id="asQrCanvas"></canvas>
      </div>
      <div id="asQrText"></div>
    </div>

    <!-- ROW 3: AMOUNT (REGULAR) -->
    <div class="form-group" id="rowAmount" 
         style="grid-column:1; margin-top:-6px;">
      <label>Amount ($)</label>
      <input type="number" id="asAmount" />
    </div>

    <!-- ROW 3: BONUS AMOUNT (BONUS MODE) -->
    <div class="form-group" id="rowBonusAmount" 
         style="grid-column:1; margin-top:-6px; display:none;">
      <label>Bonus Amount ($)</label>
      <input type="number" id="asBonusAmount" />
    </div>

    <!-- ROW 4: SAVE BUTTON (RIGHT UNDER QR) -->
    <div class="form-group" style="grid-column:2; margin-top:-6px;">
      <label>&nbsp;</label>
      <div class="form-actions">
        <button id="asSaveBtn" class="btn btn-primary">Save & Print</button>
      </div>
    </div>

  </div>
</div>
  </div>
</div>

<!-- ============================
     PRINT MODAL (BOTTOM OF PAGE)
============================= -->
<div id="asPrintOverlay" style="
  position: fixed;
  inset: 0;
  background: rgba(0,0,0,0.5);
  display: none;
  align-items: center;
  justify-content: center;
  z-index: 9999;
">
  <div id="asPrintModal" style="
    background: #ffffff00;
    padding: 15px;
    border-radius: 8px;
    width: 320px;
    box-shadow: 0 0 10px rgba(0,0,0,0.3);
  ">
    <div class="slip-container" style="width:300px;border:1px solid #333;padding:15px;border-radius:8px;font-family:Arial,sans-serif;">
      <div style="text-align:center;font-weight:bold;margin-bottom:10px;">Agent Silver Slip</div>

      <div style="display:flex;justify-content:space-between;margin:4px 0;">
        <span>Slip ID:</span> <span id="asModalSlipId"></span>
      </div>
      <div style="display:flex;justify-content:space-between;margin:4px 0;">
        <span>Date/Time:</span> <span id="asModalSlipDateTime"></span>
      </div>
      <div style="display:flex;justify-content:space-between;margin:4px 0;">
        <span>Agent:</span> <span id="asModalSlipAgent"></span>
      </div>

      <div id="asModalRowMachine" style="display:flex;justify-content:space-between;margin:4px 0;">
        <span>Machine:</span> <span id="asModalSlipMachine"></span>
      </div>
      <div id="asModalRowAmount" style="display:flex;justify-content:space-between;margin:4px 0;">
        <span>Amount:</span> <span id="asModalSlipAmount"></span>
      </div>

      <div id="asModalRowBonusType" style="display:none;justify-content:space-between;margin:4px 0;">
        <span>Bonus Type:</span> <span id="asModalSlipBonusType"></span>
      </div>
      <div id="asModalRowBonusAmount" style="display:none;justify-content:space-between;margin:4px 0;">
        <span>Bonus Amount:</span> <span id="asModalSlipBonusAmount"></span>
      </div>

      <div style="text-align:center;margin-top:15px;">
        <canvas id="asModalQrCanvas" width="128" height="128"></canvas>
        <div style="font-size:12px;color:#666;">Scan to confirm payment</div>
      </div>

      <div style="text-align:center;font-size:12px;margin-top:10px;border-top:1px dashed #999;padding-top:5px;">
        Game Audit System
      </div>

      <div style="margin-top:10px;display:flex;justify-content:space-between;">
        <button id="asModalPrintBtn">Print</button>
        <button id="asModalCloseBtn">Close</button>
      </div>
    </div>
  </div>
</div>

<!-- PRINT CSS -->
<style>
  @media print {
    body * {
      visibility: hidden !important;
    }
    #asPrintOverlay, #asPrintOverlay * {
      visibility: visible !important;
    }
    #asPrintOverlay {
      position: fixed;
      inset: 0;
    }
  }

  .as-slip-type-buttons {
    display: flex;
    gap: 10px;
  }

  .as-slip-btn {
    flex: 1;
    padding: 10px;
    border-radius: 6px;
    border: 1px solid #444;
    background: #222;
    color: #fff;
    font-size: 14px;
    cursor: pointer;
    transition: 0.2s;
  }

  .as-slip-btn.active {
    background: #007bff;
    border-color: #007bff;
  }
</style>

<!-- QRious -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/qrious/4.0.2/qrious.min.js"></script>

<!-- Agent Silver JS -->
<script type="module" src="/js_new/agentSilver.js"></script>
