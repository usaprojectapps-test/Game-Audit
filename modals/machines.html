<div id="machines-module" class="module machines-module">

  <!-- HEADER: Search + Filters + Buttons -->
  <div class="module-header">
    <div class="filters-row compact-row">
      <input
        type="text"
        id="machines-search-input"
        class="input"
        placeholder="Search by Machine ID or Name"
      />
      <select id="machines-health-filter" class="select">
        <option value="">All</option>
        <option value="Good">Good</option>
        <option value="Warning">Warning</option>
        <option value="Critical">Critical</option>
      </select>
      <select id="machines-location-filter" class="select superadmin-only">
        <option value="">All locations</option>
      </select>
      <button id="machines-refresh-btn" class="btn btn-secondary">Refresh</button>
      <button id="machines-export-csv-btn" class="btn btn-secondary">Export CSV</button>
    </div>
  </div>

  <!-- BODY: Left (Table) + Right (Form) -->
  <div class="module-body">

    <!-- LEFT SIDE: TABLE -->
    <div class="module-left">
      <div class="card table-card">
        <div class="table-wrapper">
          <table>
            <thead>
              <tr>
                <th>Machine ID</th>
                <th>Machine Name</th>
                <th>Vendor</th>
                <th>Health</th>
                <th>Last Service</th>
                <th>Location</th>
              </tr>
            </thead>
            <tbody id="machines-table-body"></tbody>
          </table>
        </div>

        <!-- Pagination -->
        <div class="table-footer">
          <span id="machines-pagination-text">Showing 0 of 0</span>
          <div class="pagination-controls">
            <button id="machines-prev-page" class="btn btn-icon" disabled>&lt;</button>
            <span id="machines-current-page" class="pagination-page">1</span>
            <button id="machines-next-page" class="btn btn-icon" disabled>&gt;</button>
          </div>
        </div>
      </div>
    </div>

    <!-- RIGHT SIDE: FORM + QR + SUMMARY + TIMELINE -->
    <div class="module-right">

      <!-- FORM -->
      <div class="card form-card">
        <div class="card-header">
          <h3 id="machines-form-title">Add Machine</h3>
          <span id="machines-form-mode" class="badge badge-secondary">New</span>
        </div>

        <div class="card-body">
          <div class="form-grid">

            <div class="form-group">
              <label class="form-label">Machine ID</label>
              <input type="text" id="machines-machineid-input" class="input" placeholder="M001" />
            </div>

            <div class="form-group">
              <label class="form-label">Machine Name</label>
              <input type="text" id="machines-machinename-input" class="input" placeholder="Machine name" />
            </div>

            <div class="form-group">
              <label class="form-label">Vendor</label>
              <select id="machines-vendor-select" class="select">
                <option value="">Select vendor</option>
              </select>
            </div>

            <div class="form-group superadmin-only">
              <label class="form-label">Location</label>
              <select id="machines-location-select" class="select">
                <option value="">Select location</option>
              </select>
            </div>

            <div class="form-group">
              <label class="form-label">Health Status</label>
              <select id="machines-health-select" class="select">
                <option value="Good">Good</option>
                <option value="Warning">Warning</option>
                <option value="Critical">Critical</option>
              </select>
            </div>

            <div class="form-group">
              <label class="form-label">Last Service Date</label>
              <input type="date" id="machines-lastservice-input" class="input" />
            </div>

            <!-- Notes + QR side-by-side -->
          <div class="form-group form-group-full notes-qr-row">
            <div class="notes-column">
              <label class="form-label">Notes</label>
              <textarea id="machines-notes-input" class="textarea" rows="2" style="width: 100%; resize: vertical;"></textarea>
            </div>

            <div class="qr-column">
              <label class="form-label">Machine QR Code</label>
              <div id="machines-qr-preview" class="qr-preview">
                <span class="qr-placeholder-text">QR will appear here</span>
              </div>
            </div>
          </div>

          <!-- QR action buttons below -->
          <div class="qr-actions-row">
            <button id="machines-generate-qr-btn" class="btn btn-secondary">Generate QR</button>
            <button id="machines-print-qr-btn" class="btn btn-secondary">Print</button>
            <button id="machines-download-qr-btn" class="btn btn-secondary">Download</button>
          </div>

          <!-- Form action buttons below -->
          <div class="form-actions button-row">
            <button id="machines-reset-btn" class="btn btn-secondary">Clear</button>
            <button id="machines-delete-btn" class="btn btn-danger">Delete</button>
            <button id="machines-save-btn" class="btn btn-primary">Save</button>
          </div>


          </div>
        </div>

        <!-- Aligned buttons -->
        <div class="card-footer form-actions button-row">
          <button id="machines-reset-btn" class="btn btn-secondary">Clear</button>
          <button id="machines-delete-btn" class="btn btn-danger">Delete</button>
          <button id="machines-save-btn" class="btn btn-primary">Save</button>
        </div>
      </div>

      <!-- SUMMARY + TIMELINE -->
      <div class="card insights-card">

        <div class="insights-section">
          <h4>Machine Summary</h4>
          <div class="summary-content">
            <div class="summary-row">
              <span class="summary-label">Health:</span>
              <span id="machines-summary-health" class="summary-value">—</span>
            </div>
            <div class="summary-row">
              <span class="summary-label">Last Service:</span>
              <span id="machines-summary-lastservice" class="summary-value">—</span>
            </div>
            <div class="summary-row">
              <span class="summary-label">Vendor:</span>
              <span id="machines-summary-vendor" class="summary-value">—</span>
            </div>
            <div class="summary-row">
              <span class="summary-label">Location:</span>
              <span id="machines-summary-location" class="summary-value">—</span>
            </div>
          </div>
        </div>

        <div class="insights-section">
          <h4>Machine Timeline</h4>
          <div id="machines-timeline-content" class="timeline-content">
            <div class="timeline-empty">No events yet</div>
          </div>
        </div>

      </div>

    </div>
  </div>

  <!-- TOASTS -->
  <div id="machines-toast-container" class="toast-container"></div>
</div>
